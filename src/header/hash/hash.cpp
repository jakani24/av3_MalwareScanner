#ifndef HASH_CPP
#define HASH_CPP
#include <cstring>
#include <iostream>
#include "../os.h"
#include "hash.h"
int get_hash(char*path,char*out_hash)//returns NULL if an error occurs
{
	char buf[500];
	FILE*fp;
	#ifdef os_win
	sprintf(buf,"certutil -hashfile \"%s\" MD5 > c:\\programdata\\jakach\\se\\hashes\\hashfile.jdbf",path);
	system(buf);
	if((fp=fopen("c:\\programdata\\jakach\\se\\hashes\\hashfile.jdbf","r"))==0)
	{
		return 0;
	}
	else
	{
		fgets(buf,495,fp);
		fscanf(fp,"%50s",&buf);
		fclose(fp);
		strcpy(out_hash,buf);
	}
	
	#endif
	
	#ifdef os_linux
	sprintf(buf,"md5sum %s> /etc/jakach/hashfile.jdbf",path);
	system(buf);
	if((fp=fopen("/etc/jakach/hashfile.jdbf","r"))==0)
	{
		return 0;
	}
	else
	{
		fscanf(fp,"%50s",&buf);
		fclose(fp);
		strcpy(out_hash,buf);
	}
	#endif
	return 1;
}
#endif